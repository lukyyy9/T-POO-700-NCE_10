version: '3'

services:
   backend:
      image: imluky/backend:latest
      env_file: ./backend/.env
      build:
         context: ./backend
      ports:
         - "4000:4000"
      depends_on:
         - db
   db:
      image: postgres:9.6
      env_file: .env
      restart: always
      volumes:
         - pgdata:/var/lib/postgresql/data
   frontend:
      image: imluky/frontend:latest
      env_file: ./frontend/.env
      build:
         context: ./frontend
         dockerfile: Dockerfile
      ports:
         - "80:80"
      volumes:
         - ./frontend:/app
      
volumes:
   pgdata: